# ========================================
# SPOTEX CMS - Quick Start Guide
# ========================================

## ğŸš€ Avvio Rapido

### 1. Setup Iniziale
```bash
# Configura ambiente
make setup

# Genera certificati SSL (opzionale per sviluppo)
make ssl
```

### 2. Avvia il Progetto

**Sviluppo (con hot reload):**
```bash
make dev
# oppure
docker-compose -f docker-compose.dev.yml up
```

**Produzione:**
```bash
make prod
# oppure
docker-compose up -d --build
```

## ğŸŒ URLs Disponibili

- **Backend API**: http://localhost:8000
- **API Docs**: http://localhost:8000/docs
- **Admin Panel**: http://localhost:3000
- **Public Site**: http://localhost:3001
- **Nginx Gateway**: http://localhost:80
  - Admin via Nginx: http://localhost/admin
  - API via Nginx: http://localhost/api

**Database:**
- PostgreSQL: localhost:5432
- Redis: localhost:6379

## ğŸ“‹ Comandi Utili

```bash
make help              # Mostra tutti i comandi disponibili
make logs              # Visualizza log di tutti i servizi
make logs-backend      # Log solo del backend
make ps                # Stato dei container
make health            # Verifica health dei servizi
make restart           # Riavvia tutti i servizi
make down              # Ferma tutti i servizi
make clean             # Pulizia completa
```

## ğŸ—„ï¸ Gestione Database

```bash
make shell-db          # Accesso psql
make backup-db         # Backup database
make restore-db FILE=backup.sql  # Ripristina backup
make migrate           # Esegui migrazioni
make migrate-create MSG="descrizione"  # Crea migrazione
```

## ğŸ”§ Sviluppo

```bash
make shell-backend     # Shell nel container backend
make install-backend   # Reinstalla dipendenze backend
make install-admin     # Reinstalla dipendenze frontend admin
make test-backend      # Esegui test backend
```

## ğŸ“¦ Aggiornamenti

```bash
make update            # Aggiorna immagini Docker
make prune             # Pulisci risorse non utilizzate
```

## ğŸ” SSL/HTTPS

Per abilitare HTTPS in sviluppo:

1. Genera certificati: `make ssl`
2. Rinomina `nginx/conf.d/ssl.conf.example` in `ssl.conf`
3. Riavvia: `make restart`

## ğŸ—ï¸ Architettura

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Nginx (Port 80/443)        â”‚
â”‚            (Reverse Proxy + SSL)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Backend   â”‚  â”‚  Frontend   â”‚
    â”‚  (FastAPI)  â”‚  â”‚  (Next.js)  â”‚
    â”‚  Port 8000  â”‚  â”‚  Port 3000  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚  Port 3001  â”‚
           â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚  PostgreSQL â”‚
    â”‚  Port 5432  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Redis    â”‚
    â”‚  Port 6379  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš™ï¸ Configurazione Avanzata

### PostgreSQL Performance
Modifica in `.env`:
```bash
POSTGRES_SHARED_BUFFERS=512MB
POSTGRES_EFFECTIVE_CACHE_SIZE=2GB
POSTGRES_MAX_CONNECTIONS=200
```

### Backend Workers
```bash
WORKERS=8
UVICORN_LIMIT_CONCURRENCY=2000
```

### Resource Limits
```bash
BACKEND_MEMORY_LIMIT=2G
BACKEND_CPU_LIMIT=4
```

## ğŸ› Troubleshooting

**Container non si avvia:**
```bash
docker-compose logs [service-name]
docker-compose down -v
docker-compose up --build
```

**Database connection error:**
```bash
# Verifica che PostgreSQL sia healthy
docker-compose ps
make health
```

**Port giÃ  in uso:**
```bash
# Modifica le porte in .env
BACKEND_PORT=8001
ADMIN_PORT=3002
```

## ğŸ“š Documentazione API

Una volta avviato il backend, visita:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## ğŸ”’ Sicurezza per Produzione

1. **Cambia le password in .env:**
   - POSTGRES_PASSWORD
   - JWT_SECRET_KEY
   - REDIS_PASSWORD

2. **Usa certificati SSL validi** (Let's Encrypt)

3. **Disabilita DEBUG:**
   ```bash
   DEBUG=false
   NODE_ENV=production
   ```

4. **Configura ALLOWED_ORIGINS** con i tuoi domini reali

5. **Usa firewall** per limitare accesso a porte DB

## ğŸ“ Support

Per problemi o domande, consulta la documentazione completa o contatta il team di sviluppo.
